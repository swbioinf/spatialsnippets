<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Sarah Williams" />


<title>Differential expression between groups using pseudobulk (with pseudoreplicates)</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Spatial Sampler</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Tests</a>
</li>
<li>
  <a href="index_data.html">Data</a>
</li>
<li>
  <a href="contributing.html">Contributing</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/swbioinf/spatialsnippets">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Differential expression between groups
using pseudobulk (with pseudoreplicates)</h1>
<h4 class="author">Sarah Williams</h4>

</div>


<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6096346/"
class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6096346/</a></p>
<!-- keywords

insituspatial
seurat
de
test

-->
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>Once we have identified cell types present in the samples, its common
to test how gene expression changes between experimental conditions,
within each different cell type.</p>
<p>Some cell types may be dramatically affected by the experimental
conditions, while others are not. Likewise some genes may change only in
a specific cell type, whereas others show a more general difference.</p>
<p>This document describes how to apply a <em>pseudobulk</em> approach
to test for differences between groups. In a pseudobulk approach counts
are obtained by pooling together groups of cells; in this case cells
from the of the same celltype from the same fov. These pooled counts can
then be analysed more like a bulk RNAseq experiment.</p>
<p>This is very similar to how a non-spatial single cell experiment may
be analysed.</p>
<p>However, unlike a non-spatial single cell experiment, this
experimental design has multiple FOVs from the same tissue sample; these
<em>pseudoreplicates</em> are informative but cannot be considered true
biological replicates. They can be incorporated into the statistics with
the correlate duplicates approach <span class="citation">(Smyth,
Michaud, and Scott 2005)</span>.</p>
<p>Note that there are many other approaches to calculate differential
expression in this kind of data - including those that make use of
individual cells; see review <span class="citation">(Soneson and
Robinson 2018)</span>.</p>
<p><img src="assets/insitu_spatial_pseudobulk_de.png" /></p>
<p>This test requires:</p>
<ul>
<li>Biological replicates for each group</li>
<li>Assigned cell types</li>
<li>[Optionally] Multiple fovs measured per sample</li>
</ul>
<p>For example:</p>
<ul>
<li>What genes are differentially expressed in epithelial cells in
Crohn’s disease vs healthy individuals?</li>
<li>How do genes change with treatment in each different cell type in my
sample?</li>
</ul>
<p>Steps:</p>
<ol style="list-style-type: decimal">
<li>Calculate pseudobulk</li>
<li>Filter to testable pseudobulk groups (enough cells to pool)</li>
<li>Filter to testable genes (enough expression to see changes)</li>
<li>Test for changes in gene expression</li>
<li>Plot DE results and individual genes.</li>
</ol>
</div>
<div id="worked-example" class="section level1">
<h1>Worked example</h1>
<p>How does gene expression change within each cell type between
Ulcerative colitis or Crohn’s disease, and Healthy controls?</p>
<p>Using data from <a
href="https://www.ncbi.nlm.nih.gov/pubmed/37495570"><em>Macrophage and
neutrophil heterogeneity at single-cell spatial resolution in human
inflammatory bowel disease</em></a> from <span
class="citation">(Garrido-Trigo et al. 2023)</span>;</p>
<p>The study included 9 cosmx slides of colonic biopsies</p>
<ul>
<li>3x HC - Healthy controls</li>
<li>3x UC - Ulcerative colitis</li>
<li>3x CD - Chrones’s disease</li>
</ul>
<div id="load-libraries-and-data" class="section level2">
<h2>Load libraries and data</h2>
<pre class="r"><code>library(Seurat)
library(speckle)
library(tidyverse)
library(limma)
library(DT)
library(edgeR)</code></pre>
<pre class="r"><code>data_dir              &lt;- file.path(&quot;~/projects/spatialsnippets/datasets/GSE234713_IBDcosmx_GarridoTrigo2023/processed_data&quot;) 
seurat_file_01_loaded &lt;- file.path(data_dir, &quot;GSE234713_CosMx_IBD_seurat_01_loaded.RDS&quot;)</code></pre>
<pre class="r"><code>so &lt;- readRDS(seurat_file_01_loaded)</code></pre>
</div>
<div id="experimental-design" class="section level2">
<h2>Experimental design</h2>
<!-- Move this to own page? --->
<p>There are three individuals per condition, one tissue sample from
each individual. 9 slides in total. Each tissue sample has multiple FOVs
captured; these are our pseudoreplicates. Each ‘sample’ is listed
below.</p>
<p>NB: <em>‘FOV’ Feild Of View</em>: In the seurat package, an number of
functions include an ‘fov’ parameter. This corresponds to the slide on
which one or more samples are present on. In the cosMX output an ‘fov’
refers to the rectangular regions on the slide that are measured; there
are multiple fovs per slide. This document uses the latter.</p>
<pre class="r"><code>sample_table &lt;- select(as_tibble(so@meta.data), condition, individual_code, fov_name) %&gt;%
  unique() %&gt;% 
  group_by(condition, individual_code) %&gt;% 
  summarise(n_fovs= n(), item = str_c(fov_name, collapse = &quot;, &quot;))

DT::datatable(sample_table)</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-8839f08f82529a5247be" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8839f08f82529a5247be">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9"],["Crohn's disease","Crohn's disease","Crohn's disease","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Healthy controls","Healthy controls","Healthy controls"],["CD_a","CD_b","CD_c","UC_a","UC_b","UC_c","HC_a","HC_b","HC_c"],[19,19,16,19,22,21,19,20,16],["CD_a_001, CD_a_002, CD_a_003, CD_a_004, CD_a_005, CD_a_006, CD_a_007, CD_a_008, CD_a_009, CD_a_010, CD_a_011, CD_a_012, CD_a_013, CD_a_014, CD_a_015, CD_a_016, CD_a_017, CD_a_018, CD_a_019","CD_b_002, CD_b_003, CD_b_004, CD_b_005, CD_b_006, CD_b_007, CD_b_008, CD_b_009, CD_b_010, CD_b_011, CD_b_012, CD_b_013, CD_b_014, CD_b_015, CD_b_016, CD_b_017, CD_b_018, CD_b_019, CD_b_020","CD_c_001, CD_c_002, CD_c_003, CD_c_004, CD_c_005, CD_c_006, CD_c_007, CD_c_008, CD_c_009, CD_c_010, CD_c_011, CD_c_012, CD_c_013, CD_c_014, CD_c_015, CD_c_017","UC_a_001, UC_a_002, UC_a_005, UC_a_006, UC_a_007, UC_a_008, UC_a_009, UC_a_010, UC_a_012, UC_a_013, UC_a_014, UC_a_015, UC_a_016, UC_a_017, UC_a_018, UC_a_019, UC_a_020, UC_a_021, UC_a_022","UC_b_001, UC_b_002, UC_b_003, UC_b_004, UC_b_005, UC_b_006, UC_b_007, UC_b_008, UC_b_009, UC_b_010, UC_b_011, UC_b_012, UC_b_014, UC_b_015, UC_b_016, UC_b_017, UC_b_018, UC_b_020, UC_b_021, UC_b_022, UC_b_023, UC_b_024","UC_c_001, UC_c_002, UC_c_003, UC_c_004, UC_c_005, UC_c_006, UC_c_007, UC_c_008, UC_c_009, UC_c_010, UC_c_011, UC_c_012, UC_c_013, UC_c_014, UC_c_015, UC_c_016, UC_c_017, UC_c_018, UC_c_019, UC_c_020, UC_c_021","HC_a_001, HC_a_002, HC_a_003, HC_a_004, HC_a_005, HC_a_006, HC_a_007, HC_a_008, HC_a_009, HC_a_010, HC_a_011, HC_a_012, HC_a_013, HC_a_014, HC_a_015, HC_a_016, HC_a_018, HC_a_019, HC_a_020","HC_b_001, HC_b_002, HC_b_003, HC_b_004, HC_b_005, HC_b_006, HC_b_007, HC_b_008, HC_b_009, HC_b_010, HC_b_011, HC_b_012, HC_b_013, HC_b_014, HC_b_015, HC_b_016, HC_b_017, HC_b_018, HC_b_019, HC_b_020","HC_c_001, HC_c_002, HC_c_003, HC_c_004, HC_c_005, HC_c_006, HC_c_007, HC_c_008, HC_c_009, HC_c_010, HC_c_011, HC_c_012, HC_c_013, HC_c_014, HC_c_015, HC_c_016"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>condition<\/th>\n      <th>individual_code<\/th>\n      <th>n_fovs<\/th>\n      <th>item<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"condition","targets":1},{"name":"individual_code","targets":2},{"name":"n_fovs","targets":3},{"name":"item","targets":4}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="cell-filtering-and-counting" class="section level2">
<h2>Cell filtering and counting</h2>
<p>We need to define the grouping that will make one pseudobulk sample
for analysis. In this experiment, we can consider all FOVs within a
tissue sample as somewhat equivalent. Therefore that is all cells of a
particular celltype within an FOV region.</p>
<p>If we only had one fov per sample, <em>celltype + sample</em> would
be directly equivalent.</p>
<p>If we had a tiled fovs across a tissue sample with distinct regions
it would be necessary to group them by <em>subregion fov +
celltype</em>. Alternatively pool the entire sample if each one is
equivalent - it depends on where transcriptional differences are
expected.</p>
<p>Once the pseudobulk replicate grouping is decided, we need to check
there will be enough cells to perform our analyses. Note there are
several levels of filtering here!</p>
<ul>
<li>Need at least x reads in a cell to include it</li>
<li>Need at least x cells of a celltype within an fov to include a
sample</li>
<li>Can only test where we have at least 2 samples on each side of a
contrast.</li>
</ul>
<p>What these thresholds should be needs to be determined for each
experiment.</p>
<div id="filter-counts-per-cell" class="section level3">
<h3>Filter counts per cell</h3>
<p>To start, check out the distribution of reads per cell. Here, we
choose and apply a filter of 200 reads. This is low compared to what you
might see in a single scRNAseq experiment, but we are working with only
1000 genes.</p>
<pre class="r"><code>min_reads_per_cell &lt;- 200

ggplot(so@meta.data, aes(x=nCount_RNA)) +
  geom_density() +
  geom_vline(xintercept = min_reads_per_cell, lty=3) +
  scale_x_log10() +
  theme_bw()+
  ggtitle(&quot;How many reads per cell?&quot;)</code></pre>
<p><img src="figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-1">
Past versions of unnamed-chunk-5-1.png
</button>
</p>
<div id="fig-unnamed-chunk-5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/3e314f0233f451257416b85f11d8df41c31bead4/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-5-1.png" target="_blank">3e314f0</a>
</td>
<td>
swbioinf
</td>
<td>
2025-08-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/c77f76cecb74337321d877773789d8703b9bdb89/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-5-1.png" target="_blank">c77f76c</a>
</td>
<td>
swbioinf
</td>
<td>
2024-05-07
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>so&lt;- so[,so$nCount_RNA &gt;= min_reads_per_cell]</code></pre>
</div>
<div id="filter-cells-per-group" class="section level3">
<h3>Filter cells per group</h3>
<p>Next we pool each celltype within each fov (naming those groupings
fov_cluster). But there needs to be a certain number of cells for that
to work - less than a certain number of cells and a pseudobulk pool will
be excluded. The table below shows the cells per grouping.</p>
<p>Note there are much fewer t-cells overall, but given that we have a
high number of samples, there should still be enough to include. Its
typical that some of the less common cell types are difficult or
impossible to reliably test.</p>
<pre class="r"><code>min_cells_per_fovcluster &lt;- 20

so$fov_cluster &lt;- paste0(so$fov_name,&quot;_&quot;, so$celltype_subset)

celltype_summary_table &lt;- so@meta.data %&gt;% 
  group_by(condition, group, individual_code, fov_name, celltype_subset, fov_cluster) %&gt;%
  summarise(cells=n(), .groups = &#39;drop&#39;)
DT::datatable(celltype_summary_table)</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-a4d51c6334d8450be088" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a4d51c6334d8450be088">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787"],["Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Crohn's disease","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Ulcerative colitis","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls","Healthy controls"],["CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","CD","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","UC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC","HC"],["CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_a","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_b","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","CD_c","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_a","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_b","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","UC_c","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_a","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_b","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c","HC_c"],["CD_a_001","CD_a_001","CD_a_001","CD_a_001","CD_a_001","CD_a_002","CD_a_002","CD_a_002","CD_a_002","CD_a_002","CD_a_003","CD_a_003","CD_a_003","CD_a_003","CD_a_004","CD_a_004","CD_a_004","CD_a_004","CD_a_004","CD_a_005","CD_a_005","CD_a_005","CD_a_005","CD_a_006","CD_a_006","CD_a_006","CD_a_006","CD_a_006","CD_a_007","CD_a_007","CD_a_007","CD_a_007","CD_a_007","CD_a_008","CD_a_008","CD_a_008","CD_a_008","CD_a_008","CD_a_009","CD_a_009","CD_a_009","CD_a_009","CD_a_010","CD_a_010","CD_a_010","CD_a_010","CD_a_011","CD_a_011","CD_a_011","CD_a_011","CD_a_011","CD_a_012","CD_a_012","CD_a_012","CD_a_012","CD_a_013","CD_a_013","CD_a_013","CD_a_013","CD_a_013","CD_a_014","CD_a_014","CD_a_014","CD_a_014","CD_a_014","CD_a_015","CD_a_015","CD_a_015","CD_a_015","CD_a_015","CD_a_016","CD_a_016","CD_a_016","CD_a_017","CD_a_017","CD_a_017","CD_a_017","CD_a_017","CD_a_018","CD_a_018","CD_a_018","CD_a_018","CD_a_018","CD_a_019","CD_a_019","CD_a_019","CD_a_019","CD_b_002","CD_b_002","CD_b_002","CD_b_002","CD_b_003","CD_b_003","CD_b_003","CD_b_003","CD_b_004","CD_b_004","CD_b_004","CD_b_004","CD_b_005","CD_b_005","CD_b_005","CD_b_005","CD_b_006","CD_b_006","CD_b_006","CD_b_006","CD_b_007","CD_b_007","CD_b_007","CD_b_007","CD_b_008","CD_b_008","CD_b_008","CD_b_008","CD_b_009","CD_b_009","CD_b_009","CD_b_009","CD_b_009","CD_b_010","CD_b_010","CD_b_010","CD_b_010","CD_b_011","CD_b_011","CD_b_011","CD_b_011","CD_b_011","CD_b_012","CD_b_012","CD_b_012","CD_b_012","CD_b_012","CD_b_013","CD_b_013","CD_b_013","CD_b_013","CD_b_013","CD_b_014","CD_b_014","CD_b_014","CD_b_014","CD_b_014","CD_b_015","CD_b_015","CD_b_015","CD_b_015","CD_b_015","CD_b_016","CD_b_016","CD_b_016","CD_b_016","CD_b_017","CD_b_017","CD_b_017","CD_b_017","CD_b_018","CD_b_018","CD_b_018","CD_b_018","CD_b_019","CD_b_019","CD_b_019","CD_b_019","CD_b_020","CD_b_020","CD_b_020","CD_b_020","CD_c_001","CD_c_001","CD_c_001","CD_c_001","CD_c_001","CD_c_002","CD_c_002","CD_c_002","CD_c_002","CD_c_002","CD_c_003","CD_c_003","CD_c_003","CD_c_003","CD_c_003","CD_c_004","CD_c_004","CD_c_004","CD_c_004","CD_c_004","CD_c_005","CD_c_005","CD_c_005","CD_c_005","CD_c_005","CD_c_006","CD_c_006","CD_c_006","CD_c_006","CD_c_006","CD_c_007","CD_c_007","CD_c_007","CD_c_007","CD_c_007","CD_c_008","CD_c_008","CD_c_008","CD_c_008","CD_c_008","CD_c_009","CD_c_009","CD_c_009","CD_c_009","CD_c_009","CD_c_010","CD_c_010","CD_c_010","CD_c_010","CD_c_010","CD_c_011","CD_c_011","CD_c_011","CD_c_011","CD_c_011","CD_c_012","CD_c_012","CD_c_012","CD_c_012","CD_c_013","CD_c_013","CD_c_013","CD_c_013","CD_c_013","CD_c_014","CD_c_014","CD_c_014","CD_c_014","CD_c_014","CD_c_015","CD_c_015","CD_c_015","CD_c_015","CD_c_017","CD_c_017","CD_c_017","CD_c_017","CD_c_017","UC_a_001","UC_a_001","UC_a_001","UC_a_001","UC_a_001","UC_a_002","UC_a_002","UC_a_002","UC_a_002","UC_a_002","UC_a_005","UC_a_005","UC_a_005","UC_a_005","UC_a_005","UC_a_006","UC_a_006","UC_a_006","UC_a_006","UC_a_006","UC_a_007","UC_a_007","UC_a_007","UC_a_007","UC_a_007","UC_a_008","UC_a_008","UC_a_008","UC_a_008","UC_a_008","UC_a_009","UC_a_009","UC_a_009","UC_a_009","UC_a_010","UC_a_010","UC_a_010","UC_a_010","UC_a_010","UC_a_012","UC_a_012","UC_a_012","UC_a_012","UC_a_012","UC_a_013","UC_a_013","UC_a_013","UC_a_013","UC_a_014","UC_a_014","UC_a_014","UC_a_014","UC_a_015","UC_a_015","UC_a_015","UC_a_015","UC_a_016","UC_a_016","UC_a_016","UC_a_017","UC_a_017","UC_a_017","UC_a_017","UC_a_018","UC_a_018","UC_a_018","UC_a_018","UC_a_018","UC_a_019","UC_a_019","UC_a_019","UC_a_019","UC_a_020","UC_a_020","UC_a_020","UC_a_020","UC_a_020","UC_a_021","UC_a_021","UC_a_021","UC_a_021","UC_a_022","UC_a_022","UC_a_022","UC_a_022","UC_b_001","UC_b_001","UC_b_001","UC_b_001","UC_b_001","UC_b_002","UC_b_002","UC_b_002","UC_b_002","UC_b_002","UC_b_003","UC_b_003","UC_b_003","UC_b_003","UC_b_003","UC_b_004","UC_b_004","UC_b_004","UC_b_004","UC_b_004","UC_b_005","UC_b_005","UC_b_005","UC_b_005","UC_b_006","UC_b_006","UC_b_006","UC_b_006","UC_b_006","UC_b_007","UC_b_007","UC_b_007","UC_b_007","UC_b_007","UC_b_008","UC_b_008","UC_b_008","UC_b_008","UC_b_008","UC_b_009","UC_b_009","UC_b_009","UC_b_009","UC_b_010","UC_b_010","UC_b_010","UC_b_010","UC_b_011","UC_b_011","UC_b_011","UC_b_011","UC_b_012","UC_b_012","UC_b_012","UC_b_012","UC_b_014","UC_b_014","UC_b_014","UC_b_014","UC_b_014","UC_b_015","UC_b_015","UC_b_015","UC_b_015","UC_b_015","UC_b_016","UC_b_016","UC_b_016","UC_b_016","UC_b_016","UC_b_017","UC_b_017","UC_b_017","UC_b_017","UC_b_018","UC_b_018","UC_b_018","UC_b_018","UC_b_018","UC_b_020","UC_b_020","UC_b_020","UC_b_020","UC_b_021","UC_b_021","UC_b_021","UC_b_021","UC_b_021","UC_b_022","UC_b_022","UC_b_022","UC_b_022","UC_b_022","UC_b_023","UC_b_023","UC_b_023","UC_b_023","UC_b_024","UC_b_024","UC_b_024","UC_b_024","UC_c_001","UC_c_001","UC_c_001","UC_c_001","UC_c_001","UC_c_002","UC_c_002","UC_c_002","UC_c_002","UC_c_002","UC_c_003","UC_c_003","UC_c_003","UC_c_003","UC_c_003","UC_c_004","UC_c_004","UC_c_004","UC_c_005","UC_c_005","UC_c_005","UC_c_005","UC_c_006","UC_c_006","UC_c_006","UC_c_006","UC_c_006","UC_c_007","UC_c_007","UC_c_007","UC_c_007","UC_c_007","UC_c_008","UC_c_008","UC_c_008","UC_c_008","UC_c_008","UC_c_009","UC_c_009","UC_c_009","UC_c_009","UC_c_009","UC_c_010","UC_c_010","UC_c_010","UC_c_010","UC_c_010","UC_c_011","UC_c_011","UC_c_011","UC_c_011","UC_c_011","UC_c_012","UC_c_012","UC_c_012","UC_c_012","UC_c_012","UC_c_013","UC_c_013","UC_c_013","UC_c_013","UC_c_013","UC_c_014","UC_c_014","UC_c_014","UC_c_014","UC_c_014","UC_c_015","UC_c_015","UC_c_015","UC_c_015","UC_c_015","UC_c_016","UC_c_016","UC_c_016","UC_c_016","UC_c_016","UC_c_017","UC_c_017","UC_c_017","UC_c_017","UC_c_017","UC_c_018","UC_c_018","UC_c_018","UC_c_018","UC_c_018","UC_c_019","UC_c_019","UC_c_019","UC_c_019","UC_c_019","UC_c_020","UC_c_020","UC_c_020","UC_c_020","UC_c_020","UC_c_021","UC_c_021","UC_c_021","UC_c_021","UC_c_021","HC_a_001","HC_a_001","HC_a_001","HC_a_001","HC_a_001","HC_a_002","HC_a_002","HC_a_002","HC_a_002","HC_a_002","HC_a_003","HC_a_003","HC_a_003","HC_a_003","HC_a_003","HC_a_004","HC_a_004","HC_a_004","HC_a_004","HC_a_004","HC_a_005","HC_a_005","HC_a_005","HC_a_005","HC_a_005","HC_a_006","HC_a_006","HC_a_006","HC_a_006","HC_a_006","HC_a_007","HC_a_007","HC_a_007","HC_a_007","HC_a_007","HC_a_008","HC_a_008","HC_a_008","HC_a_008","HC_a_008","HC_a_009","HC_a_009","HC_a_009","HC_a_009","HC_a_009","HC_a_010","HC_a_010","HC_a_010","HC_a_010","HC_a_010","HC_a_011","HC_a_011","HC_a_011","HC_a_011","HC_a_011","HC_a_012","HC_a_012","HC_a_012","HC_a_012","HC_a_012","HC_a_013","HC_a_013","HC_a_013","HC_a_013","HC_a_013","HC_a_014","HC_a_014","HC_a_014","HC_a_014","HC_a_014","HC_a_015","HC_a_015","HC_a_015","HC_a_015","HC_a_015","HC_a_016","HC_a_016","HC_a_016","HC_a_016","HC_a_016","HC_a_018","HC_a_018","HC_a_018","HC_a_018","HC_a_018","HC_a_019","HC_a_019","HC_a_019","HC_a_019","HC_a_019","HC_a_020","HC_a_020","HC_a_020","HC_a_020","HC_a_020","HC_b_001","HC_b_001","HC_b_001","HC_b_001","HC_b_001","HC_b_002","HC_b_002","HC_b_002","HC_b_002","HC_b_002","HC_b_003","HC_b_003","HC_b_003","HC_b_003","HC_b_003","HC_b_004","HC_b_004","HC_b_004","HC_b_004","HC_b_004","HC_b_005","HC_b_005","HC_b_005","HC_b_005","HC_b_005","HC_b_006","HC_b_006","HC_b_006","HC_b_006","HC_b_006","HC_b_007","HC_b_007","HC_b_007","HC_b_007","HC_b_007","HC_b_008","HC_b_008","HC_b_008","HC_b_008","HC_b_008","HC_b_009","HC_b_009","HC_b_009","HC_b_009","HC_b_009","HC_b_010","HC_b_010","HC_b_010","HC_b_010","HC_b_010","HC_b_011","HC_b_011","HC_b_011","HC_b_011","HC_b_011","HC_b_012","HC_b_012","HC_b_012","HC_b_012","HC_b_012","HC_b_013","HC_b_013","HC_b_013","HC_b_013","HC_b_013","HC_b_014","HC_b_014","HC_b_014","HC_b_014","HC_b_014","HC_b_015","HC_b_015","HC_b_015","HC_b_015","HC_b_015","HC_b_016","HC_b_016","HC_b_016","HC_b_016","HC_b_017","HC_b_017","HC_b_017","HC_b_017","HC_b_018","HC_b_018","HC_b_018","HC_b_019","HC_b_019","HC_b_019","HC_b_020","HC_b_020","HC_b_020","HC_b_020","HC_b_020","HC_c_001","HC_c_001","HC_c_001","HC_c_001","HC_c_001","HC_c_002","HC_c_002","HC_c_002","HC_c_002","HC_c_002","HC_c_003","HC_c_003","HC_c_003","HC_c_003","HC_c_004","HC_c_004","HC_c_004","HC_c_004","HC_c_005","HC_c_005","HC_c_005","HC_c_005","HC_c_006","HC_c_006","HC_c_006","HC_c_007","HC_c_007","HC_c_007","HC_c_007","HC_c_008","HC_c_008","HC_c_008","HC_c_008","HC_c_008","HC_c_009","HC_c_009","HC_c_009","HC_c_009","HC_c_010","HC_c_010","HC_c_011","HC_c_011","HC_c_011","HC_c_011","HC_c_012","HC_c_012","HC_c_012","HC_c_013","HC_c_013","HC_c_013","HC_c_013","HC_c_014","HC_c_014","HC_c_014","HC_c_014","HC_c_014","HC_c_015","HC_c_015","HC_c_015","HC_c_015","HC_c_016","HC_c_016","HC_c_016"],["epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","stroma","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","myeloids","plasmas","stroma","myeloids","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","epi","plasmas","stroma","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","myeloids","stroma","epi","myeloids","plasmas","stroma","epi","myeloids","stroma","epi","myeloids","plasmas","stroma","epi","myeloids","plasmas","stroma","tcells","epi","myeloids","plasmas","stroma","myeloids","plasmas","stroma"],["CD_a_001_epi","CD_a_001_myeloids","CD_a_001_plasmas","CD_a_001_stroma","CD_a_001_tcells","CD_a_002_epi","CD_a_002_myeloids","CD_a_002_plasmas","CD_a_002_stroma","CD_a_002_tcells","CD_a_003_myeloids","CD_a_003_plasmas","CD_a_003_stroma","CD_a_003_tcells","CD_a_004_epi","CD_a_004_myeloids","CD_a_004_plasmas","CD_a_004_stroma","CD_a_004_tcells","CD_a_005_myeloids","CD_a_005_plasmas","CD_a_005_stroma","CD_a_005_tcells","CD_a_006_epi","CD_a_006_myeloids","CD_a_006_plasmas","CD_a_006_stroma","CD_a_006_tcells","CD_a_007_epi","CD_a_007_myeloids","CD_a_007_plasmas","CD_a_007_stroma","CD_a_007_tcells","CD_a_008_epi","CD_a_008_myeloids","CD_a_008_plasmas","CD_a_008_stroma","CD_a_008_tcells","CD_a_009_epi","CD_a_009_myeloids","CD_a_009_plasmas","CD_a_009_stroma","CD_a_010_epi","CD_a_010_myeloids","CD_a_010_plasmas","CD_a_010_stroma","CD_a_011_epi","CD_a_011_myeloids","CD_a_011_plasmas","CD_a_011_stroma","CD_a_011_tcells","CD_a_012_epi","CD_a_012_myeloids","CD_a_012_plasmas","CD_a_012_stroma","CD_a_013_epi","CD_a_013_myeloids","CD_a_013_plasmas","CD_a_013_stroma","CD_a_013_tcells","CD_a_014_epi","CD_a_014_myeloids","CD_a_014_plasmas","CD_a_014_stroma","CD_a_014_tcells","CD_a_015_epi","CD_a_015_myeloids","CD_a_015_plasmas","CD_a_015_stroma","CD_a_015_tcells","CD_a_016_myeloids","CD_a_016_plasmas","CD_a_016_stroma","CD_a_017_epi","CD_a_017_myeloids","CD_a_017_plasmas","CD_a_017_stroma","CD_a_017_tcells","CD_a_018_epi","CD_a_018_myeloids","CD_a_018_plasmas","CD_a_018_stroma","CD_a_018_tcells","CD_a_019_epi","CD_a_019_myeloids","CD_a_019_plasmas","CD_a_019_stroma","CD_b_002_myeloids","CD_b_002_plasmas","CD_b_002_stroma","CD_b_002_tcells","CD_b_003_myeloids","CD_b_003_plasmas","CD_b_003_stroma","CD_b_003_tcells","CD_b_004_myeloids","CD_b_004_plasmas","CD_b_004_stroma","CD_b_004_tcells","CD_b_005_myeloids","CD_b_005_plasmas","CD_b_005_stroma","CD_b_005_tcells","CD_b_006_myeloids","CD_b_006_plasmas","CD_b_006_stroma","CD_b_006_tcells","CD_b_007_myeloids","CD_b_007_plasmas","CD_b_007_stroma","CD_b_007_tcells","CD_b_008_myeloids","CD_b_008_plasmas","CD_b_008_stroma","CD_b_008_tcells","CD_b_009_epi","CD_b_009_myeloids","CD_b_009_plasmas","CD_b_009_stroma","CD_b_009_tcells","CD_b_010_myeloids","CD_b_010_plasmas","CD_b_010_stroma","CD_b_010_tcells","CD_b_011_epi","CD_b_011_myeloids","CD_b_011_plasmas","CD_b_011_stroma","CD_b_011_tcells","CD_b_012_epi","CD_b_012_myeloids","CD_b_012_plasmas","CD_b_012_stroma","CD_b_012_tcells","CD_b_013_epi","CD_b_013_myeloids","CD_b_013_plasmas","CD_b_013_stroma","CD_b_013_tcells","CD_b_014_epi","CD_b_014_myeloids","CD_b_014_plasmas","CD_b_014_stroma","CD_b_014_tcells","CD_b_015_epi","CD_b_015_myeloids","CD_b_015_plasmas","CD_b_015_stroma","CD_b_015_tcells","CD_b_016_myeloids","CD_b_016_plasmas","CD_b_016_stroma","CD_b_016_tcells","CD_b_017_myeloids","CD_b_017_plasmas","CD_b_017_stroma","CD_b_017_tcells","CD_b_018_myeloids","CD_b_018_plasmas","CD_b_018_stroma","CD_b_018_tcells","CD_b_019_myeloids","CD_b_019_plasmas","CD_b_019_stroma","CD_b_019_tcells","CD_b_020_myeloids","CD_b_020_plasmas","CD_b_020_stroma","CD_b_020_tcells","CD_c_001_epi","CD_c_001_myeloids","CD_c_001_plasmas","CD_c_001_stroma","CD_c_001_tcells","CD_c_002_epi","CD_c_002_myeloids","CD_c_002_plasmas","CD_c_002_stroma","CD_c_002_tcells","CD_c_003_epi","CD_c_003_myeloids","CD_c_003_plasmas","CD_c_003_stroma","CD_c_003_tcells","CD_c_004_epi","CD_c_004_myeloids","CD_c_004_plasmas","CD_c_004_stroma","CD_c_004_tcells","CD_c_005_epi","CD_c_005_myeloids","CD_c_005_plasmas","CD_c_005_stroma","CD_c_005_tcells","CD_c_006_epi","CD_c_006_myeloids","CD_c_006_plasmas","CD_c_006_stroma","CD_c_006_tcells","CD_c_007_epi","CD_c_007_myeloids","CD_c_007_plasmas","CD_c_007_stroma","CD_c_007_tcells","CD_c_008_epi","CD_c_008_myeloids","CD_c_008_plasmas","CD_c_008_stroma","CD_c_008_tcells","CD_c_009_epi","CD_c_009_myeloids","CD_c_009_plasmas","CD_c_009_stroma","CD_c_009_tcells","CD_c_010_epi","CD_c_010_myeloids","CD_c_010_plasmas","CD_c_010_stroma","CD_c_010_tcells","CD_c_011_epi","CD_c_011_myeloids","CD_c_011_plasmas","CD_c_011_stroma","CD_c_011_tcells","CD_c_012_epi","CD_c_012_myeloids","CD_c_012_plasmas","CD_c_012_stroma","CD_c_013_epi","CD_c_013_myeloids","CD_c_013_plasmas","CD_c_013_stroma","CD_c_013_tcells","CD_c_014_epi","CD_c_014_myeloids","CD_c_014_plasmas","CD_c_014_stroma","CD_c_014_tcells","CD_c_015_epi","CD_c_015_myeloids","CD_c_015_plasmas","CD_c_015_stroma","CD_c_017_epi","CD_c_017_myeloids","CD_c_017_plasmas","CD_c_017_stroma","CD_c_017_tcells","UC_a_001_epi","UC_a_001_myeloids","UC_a_001_plasmas","UC_a_001_stroma","UC_a_001_tcells","UC_a_002_epi","UC_a_002_myeloids","UC_a_002_plasmas","UC_a_002_stroma","UC_a_002_tcells","UC_a_005_epi","UC_a_005_myeloids","UC_a_005_plasmas","UC_a_005_stroma","UC_a_005_tcells","UC_a_006_epi","UC_a_006_myeloids","UC_a_006_plasmas","UC_a_006_stroma","UC_a_006_tcells","UC_a_007_epi","UC_a_007_myeloids","UC_a_007_plasmas","UC_a_007_stroma","UC_a_007_tcells","UC_a_008_epi","UC_a_008_myeloids","UC_a_008_plasmas","UC_a_008_stroma","UC_a_008_tcells","UC_a_009_myeloids","UC_a_009_plasmas","UC_a_009_stroma","UC_a_009_tcells","UC_a_010_epi","UC_a_010_myeloids","UC_a_010_plasmas","UC_a_010_stroma","UC_a_010_tcells","UC_a_012_epi","UC_a_012_myeloids","UC_a_012_plasmas","UC_a_012_stroma","UC_a_012_tcells","UC_a_013_myeloids","UC_a_013_plasmas","UC_a_013_stroma","UC_a_013_tcells","UC_a_014_myeloids","UC_a_014_plasmas","UC_a_014_stroma","UC_a_014_tcells","UC_a_015_myeloids","UC_a_015_plasmas","UC_a_015_stroma","UC_a_015_tcells","UC_a_016_myeloids","UC_a_016_plasmas","UC_a_016_stroma","UC_a_017_myeloids","UC_a_017_plasmas","UC_a_017_stroma","UC_a_017_tcells","UC_a_018_epi","UC_a_018_myeloids","UC_a_018_plasmas","UC_a_018_stroma","UC_a_018_tcells","UC_a_019_myeloids","UC_a_019_plasmas","UC_a_019_stroma","UC_a_019_tcells","UC_a_020_epi","UC_a_020_myeloids","UC_a_020_plasmas","UC_a_020_stroma","UC_a_020_tcells","UC_a_021_myeloids","UC_a_021_plasmas","UC_a_021_stroma","UC_a_021_tcells","UC_a_022_myeloids","UC_a_022_plasmas","UC_a_022_stroma","UC_a_022_tcells","UC_b_001_epi","UC_b_001_myeloids","UC_b_001_plasmas","UC_b_001_stroma","UC_b_001_tcells","UC_b_002_epi","UC_b_002_myeloids","UC_b_002_plasmas","UC_b_002_stroma","UC_b_002_tcells","UC_b_003_epi","UC_b_003_myeloids","UC_b_003_plasmas","UC_b_003_stroma","UC_b_003_tcells","UC_b_004_epi","UC_b_004_myeloids","UC_b_004_plasmas","UC_b_004_stroma","UC_b_004_tcells","UC_b_005_myeloids","UC_b_005_plasmas","UC_b_005_stroma","UC_b_005_tcells","UC_b_006_epi","UC_b_006_myeloids","UC_b_006_plasmas","UC_b_006_stroma","UC_b_006_tcells","UC_b_007_epi","UC_b_007_myeloids","UC_b_007_plasmas","UC_b_007_stroma","UC_b_007_tcells","UC_b_008_epi","UC_b_008_myeloids","UC_b_008_plasmas","UC_b_008_stroma","UC_b_008_tcells","UC_b_009_myeloids","UC_b_009_plasmas","UC_b_009_stroma","UC_b_009_tcells","UC_b_010_myeloids","UC_b_010_plasmas","UC_b_010_stroma","UC_b_010_tcells","UC_b_011_myeloids","UC_b_011_plasmas","UC_b_011_stroma","UC_b_011_tcells","UC_b_012_myeloids","UC_b_012_plasmas","UC_b_012_stroma","UC_b_012_tcells","UC_b_014_epi","UC_b_014_myeloids","UC_b_014_plasmas","UC_b_014_stroma","UC_b_014_tcells","UC_b_015_epi","UC_b_015_myeloids","UC_b_015_plasmas","UC_b_015_stroma","UC_b_015_tcells","UC_b_016_epi","UC_b_016_myeloids","UC_b_016_plasmas","UC_b_016_stroma","UC_b_016_tcells","UC_b_017_myeloids","UC_b_017_plasmas","UC_b_017_stroma","UC_b_017_tcells","UC_b_018_epi","UC_b_018_myeloids","UC_b_018_plasmas","UC_b_018_stroma","UC_b_018_tcells","UC_b_020_myeloids","UC_b_020_plasmas","UC_b_020_stroma","UC_b_020_tcells","UC_b_021_epi","UC_b_021_myeloids","UC_b_021_plasmas","UC_b_021_stroma","UC_b_021_tcells","UC_b_022_epi","UC_b_022_myeloids","UC_b_022_plasmas","UC_b_022_stroma","UC_b_022_tcells","UC_b_023_myeloids","UC_b_023_plasmas","UC_b_023_stroma","UC_b_023_tcells","UC_b_024_myeloids","UC_b_024_plasmas","UC_b_024_stroma","UC_b_024_tcells","UC_c_001_epi","UC_c_001_myeloids","UC_c_001_plasmas","UC_c_001_stroma","UC_c_001_tcells","UC_c_002_epi","UC_c_002_myeloids","UC_c_002_plasmas","UC_c_002_stroma","UC_c_002_tcells","UC_c_003_epi","UC_c_003_myeloids","UC_c_003_plasmas","UC_c_003_stroma","UC_c_003_tcells","UC_c_004_epi","UC_c_004_myeloids","UC_c_004_stroma","UC_c_005_epi","UC_c_005_myeloids","UC_c_005_plasmas","UC_c_005_stroma","UC_c_006_epi","UC_c_006_myeloids","UC_c_006_plasmas","UC_c_006_stroma","UC_c_006_tcells","UC_c_007_epi","UC_c_007_myeloids","UC_c_007_plasmas","UC_c_007_stroma","UC_c_007_tcells","UC_c_008_epi","UC_c_008_myeloids","UC_c_008_plasmas","UC_c_008_stroma","UC_c_008_tcells","UC_c_009_epi","UC_c_009_myeloids","UC_c_009_plasmas","UC_c_009_stroma","UC_c_009_tcells","UC_c_010_epi","UC_c_010_myeloids","UC_c_010_plasmas","UC_c_010_stroma","UC_c_010_tcells","UC_c_011_epi","UC_c_011_myeloids","UC_c_011_plasmas","UC_c_011_stroma","UC_c_011_tcells","UC_c_012_epi","UC_c_012_myeloids","UC_c_012_plasmas","UC_c_012_stroma","UC_c_012_tcells","UC_c_013_epi","UC_c_013_myeloids","UC_c_013_plasmas","UC_c_013_stroma","UC_c_013_tcells","UC_c_014_epi","UC_c_014_myeloids","UC_c_014_plasmas","UC_c_014_stroma","UC_c_014_tcells","UC_c_015_epi","UC_c_015_myeloids","UC_c_015_plasmas","UC_c_015_stroma","UC_c_015_tcells","UC_c_016_epi","UC_c_016_myeloids","UC_c_016_plasmas","UC_c_016_stroma","UC_c_016_tcells","UC_c_017_epi","UC_c_017_myeloids","UC_c_017_plasmas","UC_c_017_stroma","UC_c_017_tcells","UC_c_018_epi","UC_c_018_myeloids","UC_c_018_plasmas","UC_c_018_stroma","UC_c_018_tcells","UC_c_019_epi","UC_c_019_myeloids","UC_c_019_plasmas","UC_c_019_stroma","UC_c_019_tcells","UC_c_020_epi","UC_c_020_myeloids","UC_c_020_plasmas","UC_c_020_stroma","UC_c_020_tcells","UC_c_021_epi","UC_c_021_myeloids","UC_c_021_plasmas","UC_c_021_stroma","UC_c_021_tcells","HC_a_001_epi","HC_a_001_myeloids","HC_a_001_plasmas","HC_a_001_stroma","HC_a_001_tcells","HC_a_002_epi","HC_a_002_myeloids","HC_a_002_plasmas","HC_a_002_stroma","HC_a_002_tcells","HC_a_003_epi","HC_a_003_myeloids","HC_a_003_plasmas","HC_a_003_stroma","HC_a_003_tcells","HC_a_004_epi","HC_a_004_myeloids","HC_a_004_plasmas","HC_a_004_stroma","HC_a_004_tcells","HC_a_005_epi","HC_a_005_myeloids","HC_a_005_plasmas","HC_a_005_stroma","HC_a_005_tcells","HC_a_006_epi","HC_a_006_myeloids","HC_a_006_plasmas","HC_a_006_stroma","HC_a_006_tcells","HC_a_007_epi","HC_a_007_myeloids","HC_a_007_plasmas","HC_a_007_stroma","HC_a_007_tcells","HC_a_008_epi","HC_a_008_myeloids","HC_a_008_plasmas","HC_a_008_stroma","HC_a_008_tcells","HC_a_009_epi","HC_a_009_myeloids","HC_a_009_plasmas","HC_a_009_stroma","HC_a_009_tcells","HC_a_010_epi","HC_a_010_myeloids","HC_a_010_plasmas","HC_a_010_stroma","HC_a_010_tcells","HC_a_011_epi","HC_a_011_myeloids","HC_a_011_plasmas","HC_a_011_stroma","HC_a_011_tcells","HC_a_012_epi","HC_a_012_myeloids","HC_a_012_plasmas","HC_a_012_stroma","HC_a_012_tcells","HC_a_013_epi","HC_a_013_myeloids","HC_a_013_plasmas","HC_a_013_stroma","HC_a_013_tcells","HC_a_014_epi","HC_a_014_myeloids","HC_a_014_plasmas","HC_a_014_stroma","HC_a_014_tcells","HC_a_015_epi","HC_a_015_myeloids","HC_a_015_plasmas","HC_a_015_stroma","HC_a_015_tcells","HC_a_016_epi","HC_a_016_myeloids","HC_a_016_plasmas","HC_a_016_stroma","HC_a_016_tcells","HC_a_018_epi","HC_a_018_myeloids","HC_a_018_plasmas","HC_a_018_stroma","HC_a_018_tcells","HC_a_019_epi","HC_a_019_myeloids","HC_a_019_plasmas","HC_a_019_stroma","HC_a_019_tcells","HC_a_020_epi","HC_a_020_myeloids","HC_a_020_plasmas","HC_a_020_stroma","HC_a_020_tcells","HC_b_001_epi","HC_b_001_myeloids","HC_b_001_plasmas","HC_b_001_stroma","HC_b_001_tcells","HC_b_002_epi","HC_b_002_myeloids","HC_b_002_plasmas","HC_b_002_stroma","HC_b_002_tcells","HC_b_003_epi","HC_b_003_myeloids","HC_b_003_plasmas","HC_b_003_stroma","HC_b_003_tcells","HC_b_004_epi","HC_b_004_myeloids","HC_b_004_plasmas","HC_b_004_stroma","HC_b_004_tcells","HC_b_005_epi","HC_b_005_myeloids","HC_b_005_plasmas","HC_b_005_stroma","HC_b_005_tcells","HC_b_006_epi","HC_b_006_myeloids","HC_b_006_plasmas","HC_b_006_stroma","HC_b_006_tcells","HC_b_007_epi","HC_b_007_myeloids","HC_b_007_plasmas","HC_b_007_stroma","HC_b_007_tcells","HC_b_008_epi","HC_b_008_myeloids","HC_b_008_plasmas","HC_b_008_stroma","HC_b_008_tcells","HC_b_009_epi","HC_b_009_myeloids","HC_b_009_plasmas","HC_b_009_stroma","HC_b_009_tcells","HC_b_010_epi","HC_b_010_myeloids","HC_b_010_plasmas","HC_b_010_stroma","HC_b_010_tcells","HC_b_011_epi","HC_b_011_myeloids","HC_b_011_plasmas","HC_b_011_stroma","HC_b_011_tcells","HC_b_012_epi","HC_b_012_myeloids","HC_b_012_plasmas","HC_b_012_stroma","HC_b_012_tcells","HC_b_013_epi","HC_b_013_myeloids","HC_b_013_plasmas","HC_b_013_stroma","HC_b_013_tcells","HC_b_014_epi","HC_b_014_myeloids","HC_b_014_plasmas","HC_b_014_stroma","HC_b_014_tcells","HC_b_015_epi","HC_b_015_myeloids","HC_b_015_plasmas","HC_b_015_stroma","HC_b_015_tcells","HC_b_016_epi","HC_b_016_myeloids","HC_b_016_plasmas","HC_b_016_stroma","HC_b_017_epi","HC_b_017_myeloids","HC_b_017_plasmas","HC_b_017_stroma","HC_b_018_myeloids","HC_b_018_plasmas","HC_b_018_stroma","HC_b_019_myeloids","HC_b_019_stroma","HC_b_019_tcells","HC_b_020_epi","HC_b_020_myeloids","HC_b_020_plasmas","HC_b_020_stroma","HC_b_020_tcells","HC_c_001_epi","HC_c_001_myeloids","HC_c_001_plasmas","HC_c_001_stroma","HC_c_001_tcells","HC_c_002_epi","HC_c_002_myeloids","HC_c_002_plasmas","HC_c_002_stroma","HC_c_002_tcells","HC_c_003_epi","HC_c_003_myeloids","HC_c_003_plasmas","HC_c_003_stroma","HC_c_004_epi","HC_c_004_myeloids","HC_c_004_plasmas","HC_c_004_stroma","HC_c_005_epi","HC_c_005_myeloids","HC_c_005_plasmas","HC_c_005_stroma","HC_c_006_epi","HC_c_006_plasmas","HC_c_006_stroma","HC_c_007_epi","HC_c_007_myeloids","HC_c_007_plasmas","HC_c_007_stroma","HC_c_008_epi","HC_c_008_myeloids","HC_c_008_plasmas","HC_c_008_stroma","HC_c_008_tcells","HC_c_009_epi","HC_c_009_myeloids","HC_c_009_plasmas","HC_c_009_stroma","HC_c_010_myeloids","HC_c_010_stroma","HC_c_011_epi","HC_c_011_myeloids","HC_c_011_plasmas","HC_c_011_stroma","HC_c_012_epi","HC_c_012_myeloids","HC_c_012_stroma","HC_c_013_epi","HC_c_013_myeloids","HC_c_013_plasmas","HC_c_013_stroma","HC_c_014_epi","HC_c_014_myeloids","HC_c_014_plasmas","HC_c_014_stroma","HC_c_014_tcells","HC_c_015_epi","HC_c_015_myeloids","HC_c_015_plasmas","HC_c_015_stroma","HC_c_016_myeloids","HC_c_016_plasmas","HC_c_016_stroma"],[276,10,99,78,2,2,28,2,222,21,8,1,126,5,306,25,156,69,9,19,2,189,3,23,4,9,62,3,268,18,75,66,2,334,8,98,21,1,90,6,35,21,49,1,6,1,68,2,13,2,2,54,3,6,2,83,3,7,3,1,255,6,56,35,1,30,3,6,4,2,1,2,8,25,5,6,16,1,32,5,11,14,1,328,8,30,16,806,1436,929,223,987,1690,988,206,910,891,696,172,981,445,424,291,1072,1022,530,348,683,525,796,53,755,384,586,183,3,930,1156,742,154,576,964,723,482,624,468,1046,615,140,430,777,1728,485,148,717,446,1501,567,139,606,1044,1545,560,243,212,1789,1758,816,448,917,641,1380,236,1001,2215,764,181,1335,1345,538,305,815,396,527,129,414,281,799,38,311,92,979,140,16,456,153,1156,174,35,295,25,371,95,6,8,8,188,36,2,803,184,892,207,22,288,94,433,73,2,679,97,611,137,15,436,37,278,81,11,376,87,385,129,7,492,40,357,117,2,470,38,223,110,3,139,8,76,55,677,87,664,173,3,407,118,754,195,7,161,63,129,41,104,14,137,22,3,376,94,1168,710,13,185,89,662,187,1,112,207,1806,882,14,749,95,589,205,2,707,302,1762,1018,17,1337,164,1121,324,5,67,1132,438,25,1,48,353,131,4,5,197,2656,985,23,235,1475,1092,54,174,85,346,1,118,385,210,1,93,633,188,292,772,621,11,1,143,285,448,11,123,8,916,6,1,175,26,519,10,105,21,815,10,193,35,725,16,7,258,1082,604,44,50,431,1411,846,81,12,454,1427,619,78,13,275,890,400,32,259,181,349,27,2,234,334,348,17,1,272,682,388,23,4,358,763,419,24,159,127,190,12,143,139,157,15,178,48,234,6,16,137,102,4,6,312,1005,516,48,2,256,530,326,24,11,310,1793,550,90,160,438,311,21,4,332,673,467,36,66,421,97,13,10,292,1563,495,39,3,172,973,366,17,371,1140,524,63,339,1457,500,85,372,14,47,51,2,256,8,60,47,3,421,30,89,125,7,4,3,41,2,13,1,54,747,88,94,181,12,822,70,156,250,16,726,38,119,236,13,554,40,115,131,5,939,51,85,171,11,1079,23,126,64,1,1276,115,95,148,5,751,48,95,107,6,1239,49,108,79,3,965,62,103,138,4,1081,127,118,185,10,993,40,145,210,10,1058,45,106,126,12,251,4,40,77,2,316,17,79,104,7,237,18,40,140,4,419,90,345,217,25,498,61,217,276,36,245,30,136,72,12,238,92,733,397,185,236,74,273,188,17,277,60,271,212,39,248,48,209,114,19,295,33,185,169,11,203,74,628,171,109,236,64,407,141,51,266,71,278,146,13,240,54,192,122,5,173,56,314,184,26,281,45,266,137,15,231,109,327,250,38,322,60,399,253,51,300,42,146,95,31,459,40,141,178,31,863,150,439,331,50,1261,132,549,441,329,1217,132,330,446,69,1198,84,289,395,48,1316,96,521,433,122,1224,94,182,243,8,1298,62,169,265,2,555,41,134,288,4,1101,129,974,330,106,1379,119,316,386,10,1202,50,196,303,11,1071,77,151,151,7,790,165,1268,454,462,1181,54,182,162,4,1062,53,152,261,9,662,61,428,185,199,290,39,103,224,11,2,4,88,27,1,255,11,65,1,1,31,1,204,3,20,3,42,3,1,495,45,125,117,1,157,23,77,24,435,40,123,89,239,21,88,94,112,5,12,267,19,102,48,465,74,182,149,4,337,47,168,96,6,29,303,24,96,63,2,1,14,152,4,8,92,411,64,166,89,1,4,3,1,20,1,1,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>condition<\/th>\n      <th>group<\/th>\n      <th>individual_code<\/th>\n      <th>fov_name<\/th>\n      <th>celltype_subset<\/th>\n      <th>fov_cluster<\/th>\n      <th>cells<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":7},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"condition","targets":1},{"name":"group","targets":2},{"name":"individual_code","targets":3},{"name":"fov_name","targets":4},{"name":"celltype_subset","targets":5},{"name":"fov_cluster","targets":6},{"name":"cells","targets":7}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>ggplot(celltype_summary_table, aes(x=cells, col=celltype_subset)) +
  geom_density() +
  geom_vline(xintercept=min_cells_per_fovcluster, lty=3) +
  geom_rug() +
  scale_x_log10() +
  theme_bw() +
  ggtitle(&quot;How many cells per fov-cluster?&quot;)</code></pre>
<p><img src="figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/3e314f0233f451257416b85f11d8df41c31bead4/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-7-1.png" target="_blank">3e314f0</a>
</td>
<td>
swbioinf
</td>
<td>
2025-08-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/697815489cd801e303185e38f2e764cb06d42d16/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-7-1.png" target="_blank">6978154</a>
</td>
<td>
swbioinf
</td>
<td>
2024-05-30
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/c77f76cecb74337321d877773789d8703b9bdb89/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-7-1.png" target="_blank">c77f76c</a>
</td>
<td>
swbioinf
</td>
<td>
2024-05-07
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Record the names of those fov_clusters that contain enough cells to
be used. Will use this later to filter.</p>
<pre class="r"><code>celltype_summary_table.passed &lt;- celltype_summary_table[celltype_summary_table$cells &gt;= min_cells_per_fovcluster,]
passed_fov_clusters &lt;- celltype_summary_table.passed$fov_cluster</code></pre>
</div>
<div id="samples-per-contrast." class="section level3">
<h3>Samples per contrast.</h3>
<p>Ignoring pseodureplicate fovs from a single sample, how many
bioloical samples are represented in our filtered table?</p>
<p>In this experiment, there are enough samples to run the contrasts for
every cell type.</p>
<pre class="r"><code>celltype_summary_table.passed %&gt;% select(condition, individual_code, celltype_subset) %&gt;%
  unique() %&gt;%
  group_by(condition, celltype_subset) %&gt;%
  summarise(n=n()) %&gt;% 
  pivot_wider( names_from=condition, values_from = n)</code></pre>
<pre><code># A tibble: 5 × 4
  celltype_subset `Crohn&#39;s disease` `Ulcerative colitis` `Healthy controls`
  &lt;fct&gt;                       &lt;int&gt;                &lt;int&gt;              &lt;int&gt;
1 epi                             3                    3                  3
2 myeloids                        3                    3                  3
3 plasmas                         3                    3                  3
4 stroma                          3                    3                  3
5 tcells                          3                    2                  2</code></pre>
<p>NB: What if you do need to skip constrasts? Often its easiest to
count your biological replicates at the differential expression step and
skip them there. You might need to run contrasts between groups one at a
time to do this.</p>
</div>
</div>
<div id="calculate-pseudobulk" class="section level2">
<h2>Calculate pseudobulk</h2>
<p>Now use the <em>PseudobulkExpression()</em> function to sum up each
gene’s gene expression across each <em>fov_cluster</em>.</p>
<pre class="r"><code>pseudobulk_counts &lt;- PseudobulkExpression(so, assays = &quot;RNA&quot;, layer=&quot;counts&quot;,  method = &#39;aggregate&#39;, group.by = &#39;fov_cluster&#39;)
pseudobulk_counts_matrix &lt;- pseudobulk_counts[[&quot;RNA&quot;]]

# Change - back to _. Ideally we&#39;d have neither, but - will cause problems later
colnames(pseudobulk_counts_matrix)&lt;-gsub(&quot;-&quot;,&quot;_&quot;,colnames(pseudobulk_counts_matrix))</code></pre>
<p>Now instead of counts for each individual cell, we have our
pseodubulk matrix with the pooled sum of counts for each celltype within
each fov region. So the numbers are much higher, with fewer zeros. But
note that each pool is a different size, so we can’t compare counts
directly. We will address this later with normalisation.</p>
<pre class="r"><code>pseudobulk_counts_matrix[1:10,1:4]</code></pre>
<pre><code>10 x 4 sparse Matrix of class &quot;dgCMatrix&quot;
        CD_a_001_epi CD_a_001_myeloids CD_a_001_plasmas CD_a_001_stroma
TGFB3             51                 .               21              18
PIGR            1210                 8               18              40
MALAT1          1472                16              180             323
MZT2A           3539               117             1429            1052
IL16              58                 1               41              14
XBP1             116                 3               54              29
S100A6          1726                18               62              91
CCL2              48                 2               15              21
CEACAM1           89                 1                8               4
VSIR              64                 3               15              25</code></pre>
<p>Next, filter to only those passed fov_clusters we saw earlier - this
filtered table is what we’ll use for calculating differential
expression.</p>
<p>We also need an annotation table to tell us what is in each
fov_cluster (sample, celltype, condition…). Build this by filtering the
celltype summary table made earlier.</p>
<p>For convenience we filter it to the same samples, in the same order
as the pseudobulk matrix, so we can then use those columns of data to
build our differential expression model in the next step. We need to be
careful the order remains the same.</p>
<pre class="r"><code># Filter the pseudobulk table
pseudobulk_counts_matrix &lt;- pseudobulk_counts_matrix[,passed_fov_clusters]

# And filter the celltype summary into an annotation table for only those fov_clusters
# pull in relevant annotation in a matched order
pseudobulk_anno_table &lt;- celltype_summary_table
match_order &lt;- match(passed_fov_clusters, pseudobulk_anno_table$fov_cluster)
pseudobulk_anno_table &lt;- pseudobulk_anno_table[match_order,]

# Double check that the order of samples in the annotation table matches the pseudobulk table. 
# If this is wrong then the results will be nonsense!
stopifnot(all(colnames(pseudobulk_counts_matrix) == pseudobulk_anno_table$fov_cluster  ))</code></pre>
</div>
<div id="calculate-differential-expression" class="section level2">
<h2>Calculate Differential Expression</h2>
<p>We now have a counts matrix, and an annotation table that describes
its samples.</p>
<p>This looks very much like a bulk RNAseq experiment. Except - instead
of X samples across Y conditions, we have X samples of Y conditions for
each of Z celltypes.</p>
<pre class="r"><code>pseudobulk_counts_matrix[1:10,1:4]</code></pre>
<pre><code>10 x 4 sparse Matrix of class &quot;dgCMatrix&quot;
        CD_a_001_epi CD_a_001_plasmas CD_a_001_stroma CD_a_002_myeloids
TGFB3             51               21              18                 1
PIGR            1210               18              40                 4
MALAT1          1472              180             323               193
MZT2A           3539             1429            1052               334
IL16              58               41              14                14
XBP1             116               54              29                 7
S100A6          1726               62              91                49
CCL2              48               15              21                 5
CEACAM1           89                8               4                 1
VSIR              64               15              25                12</code></pre>
<pre class="r"><code>head(pseudobulk_anno_table)</code></pre>
<pre><code># A tibble: 6 × 7
  condition     group individual_code fov_name celltype_subset fov_cluster cells
  &lt;fct&gt;         &lt;fct&gt; &lt;chr&gt;           &lt;fct&gt;    &lt;fct&gt;           &lt;chr&gt;       &lt;int&gt;
1 Crohn&#39;s dise… CD    CD_a            CD_a_001 epi             CD_a_001_e…   276
2 Crohn&#39;s dise… CD    CD_a            CD_a_001 plasmas         CD_a_001_p…    99
3 Crohn&#39;s dise… CD    CD_a            CD_a_001 stroma          CD_a_001_s…    78
4 Crohn&#39;s dise… CD    CD_a            CD_a_002 myeloids        CD_a_002_m…    28
5 Crohn&#39;s dise… CD    CD_a            CD_a_002 stroma          CD_a_002_s…   222
6 Crohn&#39;s dise… CD    CD_a            CD_a_002 tcells          CD_a_002_t…    21</code></pre>
<p>We will use a fairly standard limma differential expression
analysis.</p>
<p>We will process each celltype one at a time as follows:</p>
<ol style="list-style-type: decimal">
<li>Subset the counts matrix and annotation table to the celltype.</li>
<li>Build and fit the model. In our case, a simple one that looks for
various by disease group, blocked on individual.</li>
<li>Run the test.</li>
</ol>
<p>How to build the model and run the test will need to be customised
for your experimental design. Online resources that describe approaches
for bulk RNAseq analyses can be applied to pseudobulk analyses - see the
‘More Information’ section of this document for suggestions.</p>
<p>In this case the line <code>model.matrix( ~0 + group)</code> builds a
model where gene expression is expected to vary by group (UC/CD/HC). The
~0 part indicates a ‘intercept’, which is convenient because it means we
can include all 3 groups in our contrasts, rather than one of them being
treated as the baseline. ( NB: Mathematically, you could use ~group
alone without intercept, and define contrasts accordingly to get the
same result. )</p>
<p>But, we also need to take into account our individuals. We do this by
<em>blocking</em> on individual, and calculating a intra duplicate
correlation with <em>duplicateCorrelation()</em><span
class="citation">(Smyth, Michaud, and Scott 2005)</span>. That’s a
method from microarray times, see <a
href="https://support.bioconductor.org/p/125489/">discussion</a> for how
it is applied to bulk RNAseq data.</p>
<p>If instead we didn’t have multiple fovs per replicate, can skip
blocking or use of duplicateCorrelation(). That is more typical of a
typical of a bulk rnaseq or single cell RNAseq pseuobulk analysis.</p>
<p>Some example models:</p>
<ul>
<li><strong>~0 + group, (blocked on individual with using duplicate
Correlation)</strong> : Used here, takes into account pseodureplicate
fovs from the same samples</li>
<li><strong>~0 + group, (no blocking or duplicate correlation)</strong>
: If there was only one pseudoreplicate per individual. Either from a
single fov, or from pooling fovs.</li>
<li><strong>~0 + group + individual (no blocking or duplicate
correlation)</strong> : If this was a treatment / time point experiment
with paired samples from individuals. But only one pseodureplicate per
individual. If there were multiple fovs per tissue sample, you could add
blocking and duplicate correlation on tissue ID.</li>
<li><strong>~0 + group + celltype</strong> (with or without blocking +
duplicate correlation) : Instead of subsetting to celltype, includes
cell type in the model. This pulls more data into the stataticacs, but
makes building the contrasts challenging! Not covered here.</li>
</ul>
<pre class="r"><code># Empty list to collect results
de_result_list &lt;- list()

# celltype_subset is a matrix
for (the_celltype in levels(so$celltype_subset)) {
  
  # Subset counts andn annotation to one cell type. 
  # Ensure order remains identical!
  print(the_celltype)
  anno_table.this   &lt;- pseudobulk_anno_table[pseudobulk_anno_table$celltype_subset == the_celltype,]
  count_matrix.this &lt;- pseudobulk_counts_matrix[,anno_table.this$fov_cluster]

  
  ## Check for sufficient replicates ##
  # To do any calculations, we need at least 2 pseudobulk groups per contrast.
  # there are plenty in this experiemnt, but with less replicates and rare cell types
  # it may be neccesary to check and skip certain contrasts. Here woudl be a good 
  # if (not enouch samples to run test ) {next}
  
  # skip clusters with no samples after filtering
  if( nrow(anno_table.this) &lt; 1 ) {next}
  
  
  # Setup objects for limma
  dge &lt;- DGEList(count_matrix.this)
  dge &lt;- calcNormFactors(dge)
  
  
  
  # Build model
  group           &lt;- anno_table.this$group
  individual_code &lt;- anno_table.this$individual_code

  # Model design 
  design    &lt;- model.matrix( ~0 + group)
  
  # Run Voom
  vm  &lt;- voom(dge, design = design, plot = FALSE)
  
  # Adding dupliate correlation to use individual fovs, rather than pooled per biosample
  corrfit &lt;- duplicateCorrelation(vm, design, block=individual_code)
  fit     &lt;- lmFit(vm, design, correlation = corrfit$consensus, block=individual_code) 

  # Define and fit contrasts and run ebayes
  contrasts &lt;- makeContrasts(UCvHC  = groupUC - groupHC, 
                             CDvHC  = groupCD - groupHC,
                           levels=coef(fit))
  fit &lt;- contrasts.fit(fit, contrasts)
  fit &lt;- eBayes(fit)

  ## Look through each contrast, and extract a results table.
  for ( the_coef in colnames(contrasts) ) {
    de_result.this &lt;- topTable(fit, n = Inf, adjust.method = &quot;BH&quot;, coef = the_coef) %&gt;%
      rownames_to_column(&quot;target&quot;) %&gt;%
      mutate(contrast=the_coef,
             celltype=the_celltype) %&gt;%
      select(celltype,contrast,target,everything()) %&gt;%
      arrange(P.Value)
    
    
      de_result_list[[paste(the_celltype, the_coef, sep=&quot;_&quot;)]] &lt;- de_result.this
    
  }

  

 
}</code></pre>
<pre><code>[1] &quot;epi&quot;
[1] &quot;myeloids&quot;
[1] &quot;plasmas&quot;
[1] &quot;stroma&quot;
[1] &quot;tcells&quot;</code></pre>
<pre class="r"><code># Join together results for all celltypes, and pull out those with a singificant adjusted p-value
de_results_all &lt;- bind_rows(de_result_list)
de_results_sig &lt;- filter(de_results_all, adj.P.Val &lt; 0.01)</code></pre>
<p>Table of significant results.</p>
<pre class="r"><code>DT::datatable(mutate(de_results_sig, across(is.numeric, signif, digits = 3)))</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-0b50cf44ed0c70fb0261" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0b50cf44ed0c70fb0261">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83"],["epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","epi","myeloids","myeloids","myeloids","myeloids","myeloids","myeloids","myeloids","myeloids","myeloids","myeloids","myeloids","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","plasmas","stroma","stroma","stroma","stroma","stroma","stroma","stroma","stroma","stroma","stroma","tcells","tcells","tcells","tcells","tcells","tcells","tcells"],["UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","CDvHC","CDvHC","CDvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","CDvHC","CDvHC","CDvHC","UCvHC","UCvHC","CDvHC","CDvHC","CDvHC","CDvHC","CDvHC"],["LYZ","IGHG1","IGHG2","HLA-DRB1","SAA1","B3GNT7","LCN2","CD74","HLA-DQB1","HLA-DRB5","DUOXA2","FZD5","CXCL3","OLFM4","RPS4Y1","SERPINA1","S100P","MT1X","HLA-DPA1","CHGA","CIITA","BST2","IGHG2","S100P","IGHG1","HLA-DRB1","HLA-DPA1","NFKBIA","JCHAIN","IGHG1","PIGR","IGHA1","IGHG2","FCGR3A","EZR","IGHG2","STAT1","IGHG1","TNFRSF18","IGHG2","ADAMDEC1","PIGR","IGHG1","TNFRSF13B","CXCL14","CCL3","MPO","KRT8","AQP8","BCL2","TSLP","NFKBIA","CSF2RB","IL10RA","DUSP5","BMP6","IGHA1","ADAMDEC1","PIGR","CFD","CCL3","TYK2","BMP6","IGHG2","NFKBIA","TNFRSF18","CHI3L1","IGHG2","PIGR","IGHG1","RGS2","ADIRF","NEAT1","IGHG1","IGHG2","GSN","IGHG2","IGHG1","IGHG2","IGHG1","NKG7","IGFBP3","CCL5"],[3.59,2.88,2.8,2.39,1.65,-2.22,3.02,2.71,1.52,2.35,1.94,-1.37,1.45,3.25,1.61,1.54,1.67,-1.61,1.64,-2.46,1.78,1.19,1.82,1.66,1.74,1.68,1.71,-1.3,-3.02,2.63,-1.63,-2.48,2.5,1.24,-1.15,2.97,1.43,2.9,-1.49,2.79,-1.98,-1.67,2.41,-1.33,-1.51,-1.26,1.07,-1.18,0.892,-0.954,1.05,-1.01,-0.927,-0.828,-1.15,-1.19,-1.89,-2.14,-1.66,-1.15,-1.23,-1.48,-1.35,1.66,-1.05,-0.779,1.73,2.39,-1.54,2.28,-1.07,-1.1,1.02,2.69,2.6,-1.44,3.77,3.76,3.13,2.82,1.76,-1.67,1.5],[10,10.6,10.1,10.5,9.289999999999999,10.2,9.83,11.1,9.73,9.01,9.27,11,10.5,11.6,8.17,10.9,10.9,11,9.390000000000001,9.84,9.01,8.68,10.1,10.9,10.6,10.5,9.390000000000001,10.8,11.6,12.7,9.5,13.4,12.2,10.5,9.529999999999999,12.2,10.5,12.7,9.859999999999999,14.3,9.65,9.369999999999999,14.7,9.34,9.789999999999999,9.26,8.98,10.8,9.220000000000001,9.84,8.44,10.2,9.73,9.800000000000001,11.9,9.23,16,9.65,9.369999999999999,9.85,9.26,12,9.23,14.3,10.2,9.859999999999999,9.68,12,9.52,12.6,10.5,9.76,12.8,12.6,12,11.7,12.8,13.3,12.8,13.3,10.2,9.01,11.9],[7.3,6.94,6.94,6,5.86,-5.67,5.59,5.38,5.3,4.99,4.92,-4.81,4.8,4.69,4.12,4.1,4.09,-4.03,3.94,-3.93,5.06,5.03,4.79,4.63,4.53,4.42,4.32,-5.63,-5.52,4.93,-4.75,-4.71,4.7,4.59,-4.56,5.17,5.17,5.05,-7.99,7.58,-6.54,-6.08,5.85,-5.4,-5.11,-4.99,4.75,-4.63,4.5,-4.48,4.12,-4.08,-4.07,-4.04,-3.92,-3.91,-3.86,-6.95,-5.96,-5.11,-4.81,-4.49,-4.39,4.19,-4.03,-4.03,5.33,4.96,-4.89,4.65,-4.49,-4.18,4.11,5.46,5.35,-4.31,7.45,7.17,6.3,5.5,4.86,-4.58,4.5],[3.63e-11,2.26e-10,2.27e-10,2.21e-08,4.38e-08,1.01e-07,1.5e-07,3.78e-07,5.34e-07,2.08e-06,2.86e-06,4.44e-06,4.66e-06,7.53e-06,7.15e-05,7.52e-05,7.889999999999999e-05,9.93e-05,0.000136,0.000145,1.57e-06,1.77e-06,4.98e-06,9.300000000000001e-06,1.43e-05,2.16e-05,3.28e-05,8.659999999999999e-08,1.47e-07,2.21e-06,4.68e-06,5.67e-06,5.79e-06,9.37e-06,1.07e-05,7.36e-07,7.58e-07,1.28e-06,2.27e-13,2.39e-12,7.55e-10,8.14e-09,2.64e-08,2.27e-07,8.93e-07,1.55e-06,4.46e-06,7.47e-06,1.26e-05,1.38e-05,5.97e-05,7.12e-05,7.36e-05,8.31e-05,0.00013,0.000135,0.000164,8.050000000000001e-11,1.51e-08,8.82e-07,3.45e-06,1.36e-05,2.03e-05,4.57e-05,8.509999999999999e-05,8.54e-05,3.04e-07,1.68e-06,2.3e-06,6.6e-06,1.29e-05,4.73e-05,6.02e-05,1.64e-07,2.75e-07,2.71e-05,9.46e-11,3.25e-10,1.52e-08,4.49e-07,5.8e-06,1.71e-05,2.27e-05],[3.56e-08,7.41e-08,7.41e-08,5.41e-06,8.579999999999999e-06,1.65e-05,2.1e-05,4.63e-05,5.82e-05,0.000204,0.000255,0.000352,0.000352,0.000527,0.00455,0.00455,0.00455,0.00541,0.00702,0.00709,0.000869,0.000869,0.00163,0.00228,0.00281,0.00353,0.00459,7.220000000000001e-05,7.220000000000001e-05,0.000723,0.000945,0.000945,0.000945,0.00131,0.00132,0.000371,0.000371,0.000417,2.22e-10,1.17e-09,2.47e-07,1.99e-06,5.17e-06,3.7e-05,0.000125,0.00019,0.000486,0.000732,0.00112,0.00113,0.0045,0.00481,0.00481,0.00509,0.00736,0.00736,0.008449999999999999,7.89e-08,7.38e-06,0.000288,0.000845,0.00267,0.00331,0.0064,0.009299999999999999,0.009299999999999999,0.000298,0.000752,0.000752,0.00162,0.00253,0.00772,0.00842,0.000135,0.000135,0.008840000000000001,9.27e-08,1.59e-07,1.49e-05,0.00022,0.00189,0.00419,0.00445],[15,13.3,13.3,8.960000000000001,8.31,7.52,7.15,6.29,5.94,4.66,4.36,3.99,3.93,3.51,1.35,1.35,1.32,1.12,0.745,0.726,4.95,4.84,3.89,3.31,2.92,2.55,2.17,7.63,7.12,4.62,3.93,3.75,3.74,3.3,3.17,5.58,5.56,5.08,19.9,17.5,12.1,9.789999999999999,8.720000000000001,6.59,5.29,4.75,3.77,3.29,2.78,2.68,1.33,1.14,1.1,0.983,0.653,0.531,0.721,14.2,9.27,5.47,4.2,2.94,2.56,1.77,1.26,1.25,6.45,4.83,4.58,3.57,2.99,1.79,1.6,6.8,6.4,2.31,13.7,12.5,9.25,6.13,3.78,2.79,2.54]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>contrast<\/th>\n      <th>target<\/th>\n      <th>logFC<\/th>\n      <th>AveExpr<\/th>\n      <th>t<\/th>\n      <th>P.Value<\/th>\n      <th>adj.P.Val<\/th>\n      <th>B<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"celltype","targets":1},{"name":"contrast","targets":2},{"name":"target","targets":3},{"name":"logFC","targets":4},{"name":"AveExpr","targets":5},{"name":"t","targets":6},{"name":"P.Value","targets":7},{"name":"adj.P.Val","targets":8},{"name":"B","targets":9}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="de-plots" class="section level2">
<h2>DE plots</h2>
<p>The below plots show the logFC calculate for each gene versus its
average expression across all samples. This is a useful diagnostic plot
to evaluate your differential expression results.</p>
<ul>
<li>Only big changes are significant at lower expressions, simply
becuase higher expression means more statistical confidence.</li>
<li>A lopsided plot might indicate some oddness around the normalisation
of your data (e.g. extremely different cell counts).</li>
</ul>
<!-- [[ADD pvalue plot?]] -->
<pre class="r"><code>library(ggrepel) # gg_repel, For non-overlapping gene labels


make_ma_style_plot &lt;- function(res_table, pval_threshold = 0.01, n_genes_to_label = 10) {
  p &lt;- ggplot(res_table, aes(x=AveExpr, y=logFC, col=adj.P.Val &lt; pval_threshold) ) +
    geom_hline(yintercept = c(0), col=&#39;grey80&#39;) +
    geom_point(pch=3) +
    geom_text_repel(data    = head(arrange(filter(res_table , adj.P.Val &lt; pval_threshold ), P.Value), n=5),
                    mapping = aes(label=target), col=&quot;red&quot; ) +
    theme_bw() +
    geom_hline(yintercept = c(-1,1), lty=3) +
    scale_colour_manual(values = c(&#39;FALSE&#39;=&quot;black&quot;, &#39;TRUE&#39;=&quot;red&quot;)) +
    theme(legend.position = &#39;none&#39;)
  return(p)
}</code></pre>
<pre class="r"><code>#res_table.UCvHC.epi &lt;- filter(de_results_all, contrast == &quot;UCvHC&quot;, celltype==&quot;epi&quot;)

p1 &lt;- make_ma_style_plot(res_table = filter(de_results_all, contrast == &quot;UCvHC&quot;, celltype==&quot;epi&quot;)) + ggtitle(&quot;UC vs HC - epi&quot;)
p2 &lt;- make_ma_style_plot(res_table = filter(de_results_all, contrast == &quot;UCvHC&quot;, celltype==&quot;tcells&quot;))+ ggtitle(&quot;UC vs HC - T-cells&quot;)
p3 &lt;- make_ma_style_plot(res_table = filter(de_results_all, contrast == &quot;UCvHC&quot;, celltype==&quot;stroma&quot;)) + ggtitle(&quot;UC vs HC - stroma&quot;)

p1 + p2 + p3</code></pre>
<p><img src="figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-17-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-17-1">
Past versions of unnamed-chunk-17-1.png
</button>
</p>
<div id="fig-unnamed-chunk-17-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/3e314f0233f451257416b85f11d8df41c31bead4/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-17-1.png" target="_blank">3e314f0</a>
</td>
<td>
swbioinf
</td>
<td>
2025-08-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/8580064eb7ab2ec42fa85ed21e7856c9f83b05e3/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-17-1.png" target="_blank">8580064</a>
</td>
<td>
swbioinf
</td>
<td>
2024-07-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/b2fc2b069cc3c07acdc8212638f50092110b64ab/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-17-1.png" target="_blank">b2fc2b0</a>
</td>
<td>
swbioinf
</td>
<td>
2024-06-12
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/697815489cd801e303185e38f2e764cb06d42d16/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-17-1.png" target="_blank">6978154</a>
</td>
<td>
swbioinf
</td>
<td>
2024-05-30
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/5a9d7e9002faa026640cfe522a79bcf86b1ad8bf/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-17-1.png" target="_blank">5a9d7e9</a>
</td>
<td>
swbioinf
</td>
<td>
2024-05-16
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="check-some-examples" class="section level2">
<h2>Check some examples</h2>
<p>Its always worth visualising how the expression of your
differentially expressed genes really looks, with respect to your
experimental design. How best to do this depends on your experiment.</p>
<p>The results suggests that TNFRSF18 was significantly DE between
individuals with Ulcerative Colitis and Healthy Controls in plasma
cells. As a first step, there’s some very convenient seurat plots
below;</p>
<pre class="r"><code>p1 &lt;- VlnPlot(subset(so, celltype_subset == &quot;plasmas&quot;), features = &quot;TNFRSF18&quot;, group.by = &#39;group&#39;, alpha = 0.1)
p2 &lt;- FeaturePlot(so, &quot;TNFRSF18&quot;, split.by = &quot;group&quot;)
p1 / p2</code></pre>
<p><img src="figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-18-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-18-1">
Past versions of unnamed-chunk-18-1.png
</button>
</p>
<div id="fig-unnamed-chunk-18-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/3e314f0233f451257416b85f11d8df41c31bead4/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-18-1.png" target="_blank">3e314f0</a>
</td>
<td>
swbioinf
</td>
<td>
2025-08-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/8580064eb7ab2ec42fa85ed21e7856c9f83b05e3/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-18-1.png" target="_blank">8580064</a>
</td>
<td>
swbioinf
</td>
<td>
2024-07-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/b2fc2b069cc3c07acdc8212638f50092110b64ab/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-18-1.png" target="_blank">b2fc2b0</a>
</td>
<td>
swbioinf
</td>
<td>
2024-06-12
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>But it gets difficult to summarise data at the single cell level. We
can also use the the normalised pseudobulk expression to see how gene
expression varies within each fov,individual,celltype and condition -
The plot below shows an overview of normalised TNFRSF18 expression
across the entire experiment.</p>
<pre class="r"><code># Get tmm normalised coutns for all pseudobulk
# WHen we did the DE we calculated this a celltype at a time, so values might differ slightly!
dge &lt;- DGEList(pseudobulk_counts_matrix)
dge &lt;- calcNormFactors(dge)
norm_pseudobulk &lt;- cpm(dge , log=TRUE) # uses tmm normalisation

# Plot expression for TNFRSF18
plottable &lt;- cbind(pseudobulk_anno_table, expression = norm_pseudobulk[&quot;TNFRSF18&quot;,])
ggplot(plottable, aes(x=individual_code, y=expression, col=condition )) +
  geom_boxplot(outlier.shape = NA) +
  geom_point() + 
  theme_bw() + 
  theme(axis.text.x=element_text(angle = -90, hjust = 0)) + 
  facet_wrap(~celltype_subset) </code></pre>
<p><img src="figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-19-1">
Past versions of unnamed-chunk-19-1.png
</button>
</p>
<div id="fig-unnamed-chunk-19-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/3e314f0233f451257416b85f11d8df41c31bead4/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-19-1.png" target="_blank">3e314f0</a>
</td>
<td>
swbioinf
</td>
<td>
2025-08-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/8580064eb7ab2ec42fa85ed21e7856c9f83b05e3/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-19-1.png" target="_blank">8580064</a>
</td>
<td>
swbioinf
</td>
<td>
2024-07-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/b2fc2b069cc3c07acdc8212638f50092110b64ab/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-19-1.png" target="_blank">b2fc2b0</a>
</td>
<td>
swbioinf
</td>
<td>
2024-06-12
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Compared with IGHG1, which was flagged at differentially expressed
across multiple cell types.</p>
<pre class="r"><code>plottable &lt;- cbind(pseudobulk_anno_table, expression = norm_pseudobulk[&quot;IGHG1&quot;,])
ggplot(plottable, aes(x=individual_code, y=expression, col=condition )) +
  geom_boxplot(outlier.shape = NA) +
  geom_point() + 
  theme_bw() + 
  theme(axis.text.x=element_text(angle = -90, hjust = 0)) + 
  facet_wrap(~celltype_subset) </code></pre>
<p><img src="figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-20-1">
Past versions of unnamed-chunk-20-1.png
</button>
</p>
<div id="fig-unnamed-chunk-20-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/3e314f0233f451257416b85f11d8df41c31bead4/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-20-1.png" target="_blank">3e314f0</a>
</td>
<td>
swbioinf
</td>
<td>
2025-08-07
</td>
</tr>
<tr>
<td>
<a href="https://github.com/swbioinf/spatialsnippets/blob/8580064eb7ab2ec42fa85ed21e7856c9f83b05e3/docs/figure/e_DEPseudobulk_insitu.Rmd/unnamed-chunk-20-1.png" target="_blank">8580064</a>
</td>
<td>
swbioinf
</td>
<td>
2024-07-05
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="code-snippet" class="section level1">
<h1>Code Snippet</h1>
<p>Metadata coloumns used:</p>
<ul>
<li><strong>nCount_RNA</strong> : Counts per cell</li>
<li><strong>sample</strong> : The unique identifier of each tissue
sample</li>
<li><strong>cluster</strong> : The column containing the clusters to
test condition within. Test repeated for element within column. May be
cluster, cellype, niche or other cell-grouping of interest.</li>
<li><strong>group</strong> : Column containing experimental groups
(e.g. condition, treatment group)</li>
<li><strong>fov</strong> : column containing the cosmx ‘fov’ number (not
the suerat FOV which corresponds to the whole slide).</li>
</ul>
<pre class="r"><code>library(Seurat)
library(edgeR)
library(limma)
library(tidyverse)

# Set threhoehsolds
min_reads_per_cell       &lt;- 200
min_cells_per_fovcluster &lt;- 20


# Remove cells with too few counts
so &lt;- so[,so$nCount_RNA &gt;= min_reads_per_cell]


# Define pseodoreplicate groups, with all relevant sample annotation
# remove those with too few cells.
so$fov_cluster &lt;- paste0(so$fov_name,&quot;_&quot;, so$cluster)
celltype_summary_table &lt;- so@meta.data %&gt;% 
  group_by(condition, group, individual_code, fov_name, cluster, fov_cluster) %&gt;%
  summarise(cells=n(), .groups = &#39;drop&#39;)


## Calculate pseudobulk 
pseudobulk_counts &lt;- PseudobulkExpression(so, assays = &quot;RNA&quot;, layer=&quot;counts&quot;,  method = &#39;aggregate&#39;, group.by = &#39;fov_cluster&#39;)
pseudobulk_counts_matrix &lt;- pseudobulk_counts[[&quot;RNA&quot;]]
# Change - back to _. Ideally have neither and skip this step
colnames(pseudobulk_counts_matrix)&lt;-gsub(&quot;-&quot;,&quot;_&quot;,colnames(pseudobulk_counts_matrix))


# Determine fov_clusters with enough cells
# Filter both pseudobulk matrix and pseudobulk annotation 
passed_fov_clusters &lt;- celltype_summary_table$fov_cluster[celltype_summary_table$cells &gt;= min_cells_per_fovcluster]
pseudobulk_counts_matrix &lt;- pseudobulk_counts_matrix[,passed_fov_clusters]
# Create pseubulk anno table from passed clusters, matching order
match_order &lt;- match(passed_fov_clusters, celltype_summary_table$fov_cluster)
pseudobulk_anno_table &lt;- celltype_summary_table[match_order,]




# Calculate DE across every celltype
# Empty list to collect results
de_result_list &lt;- list()


for (the_celltype in unique(so$cluster)) {
  
  # Subset counts andn annotation to one cell type. 
  # Ensure order remains identical!
  print(the_celltype)
  anno_table.this   &lt;- pseudobulk_anno_table[pseudobulk_anno_table$cluster == the_celltype,]
  count_matrix.this &lt;- pseudobulk_counts_matrix[,anno_table.this$fov_cluster]

  
  ## Check for sufficient replicates ##
  # To do any calculations, we need at least 2 pseudobulk groups per contrast.
  # there are plenty in this experiemnt, but with less replicates and rare cell types
  # it may be neccesary to check and skip certain contrasts. Here woudl be a good 
  # if (not enouch samples to run test ) {next}
  
  # skip clusters with no samples after filtering
  if( nrow(anno_table.this) &lt; 1 ) {next}
  
  
  # Setup objects for limma
  dge &lt;- DGEList(count_matrix.this)
  dge &lt;- calcNormFactors(dge)
  
  
  
  # Build model
  group           &lt;- anno_table.this$group
  individual_code &lt;- anno_table.this$individual_code

  # Model design 
  design    &lt;- model.matrix( ~0 + group)
  
  # Run Voom
  vm  &lt;- voom(dge, design = design, plot = FALSE)
  
  # Adding dupliate correlation to use individual fovs, rather than pooled per biosample
  corrfit &lt;- duplicateCorrelation(vm, design, block=individual_code)
  fit     &lt;- lmFit(vm, design, correlation = corrfit$consensus, block=individual_code) 

  # Define and fit contrasts and run ebayes
  contrasts &lt;- makeContrasts(AvsControl  = groupGroupA - groupControl, 
                             #BvsControl  = groupGroupB - groupControl,
                             # ...
                           levels=coef(fit))
  fit &lt;- contrasts.fit(fit, contrasts)
  fit &lt;- eBayes(fit)

  ## Look through each contrast, and extract a results table.
  for ( the_coef in colnames(contrasts) ) {
    de_result.this &lt;- topTable(fit, n = Inf, adjust.method = &quot;BH&quot;, coef = the_coef) %&gt;%
      rownames_to_column(&quot;target&quot;) %&gt;%
      mutate(contrast=the_coef,
             celltype=the_celltype) %&gt;%
      select(celltype,contrast,target,everything()) %&gt;%
      arrange(P.Value)
    
    
      de_result_list[[paste(the_celltype, the_coef, sep=&quot;_&quot;)]] &lt;- de_result.this
    
  }

  

 
}

# Join together results for all celltypes, and pull out those with a singificant adjusted p-value
de_results_all &lt;- bind_rows(de_result_list)
de_results_sig &lt;- filter(de_results_all, adj.P.Val &lt; 0.01)</code></pre>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<pre class="r"><code>DT::datatable(mutate(head(de_results_sig), across(is.numeric, signif, digits = 3)))</code></pre>
<div class="datatables html-widget html-fill-item" id="htmlwidget-02919026514f0c819cc6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-02919026514f0c819cc6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],["epi","epi","epi","epi","epi","epi"],["UCvHC","UCvHC","UCvHC","UCvHC","UCvHC","UCvHC"],["LYZ","IGHG1","IGHG2","HLA-DRB1","SAA1","B3GNT7"],[3.59,2.88,2.8,2.39,1.65,-2.22],[10,10.6,10.1,10.5,9.289999999999999,10.2],[7.3,6.94,6.94,6,5.86,-5.67],[3.63e-11,2.26e-10,2.27e-10,2.21e-08,4.38e-08,1.01e-07],[3.56e-08,7.41e-08,7.41e-08,5.41e-06,8.579999999999999e-06,1.65e-05],[15,13.3,13.3,8.960000000000001,8.31,7.52]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>contrast<\/th>\n      <th>target<\/th>\n      <th>logFC<\/th>\n      <th>AveExpr<\/th>\n      <th>t<\/th>\n      <th>P.Value<\/th>\n      <th>adj.P.Val<\/th>\n      <th>B<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"celltype","targets":1},{"name":"contrast","targets":2},{"name":"target","targets":3},{"name":"logFC","targets":4},{"name":"AveExpr","targets":5},{"name":"t","targets":6},{"name":"P.Value","targets":7},{"name":"adj.P.Val","targets":8},{"name":"B","targets":9}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<p>This table is the typical output of <em>limma</em> tests; With a
couple of extra columns added by our code.</p>
<ul>
<li><strong>celltype</strong>: The celltype being tested (Added by
example code)</li>
<li><strong>contrast</strong>: The contrast being tested (Added by
example code)</li>
<li><strong>target</strong> : The gene name (Added by example code, is
the rowname in limma output)</li>
<li><strong>rownames</strong> : The tested cell types</li>
<li><strong>logFC</strong> : Log 2 fold change between tested groups.
For a test of Test-Con;
<ul>
<li>At logFC +1, A is doubled B.</li>
<li>At logFC -1, A is half of B.<br />
</li>
<li>A logFC 0 indicates no change.</li>
</ul></li>
<li><strong>AveExpr</strong> : Average expression of a gene across all
replicates.</li>
<li><strong>t</strong> : Moderated T-statistic. See Limma
documentation.</li>
<li><strong>P.Value</strong> : P.value</li>
<li><strong>adj.P.Val</strong> : A multiple-hypothesis corrected
p-value</li>
<li><strong>B</strong> : B statistic (rarely used). See Limma
documentation.</li>
</ul>
</div>
<div id="more-information" class="section level1">
<h1>More Information</h1>
<ul>
<li><a href="https://bioconductor.org/books/release/OSCA/">‘Ochestrating
single cell analysis with bioconductor’ book chapter ‘DE analyses
between conditions’</a> : An explanation of the ‘pseudobulk’ approch to
single cell differential expression calculation.</li>
<li><a
href="https://bioconductor.org/packages/release/bioc/vignettes/glmGamPoi/inst/doc/pseudobulk.html">Pseudobulk
and differential expression (glmGamPoi documentation)</a>: Part of the
documentation for the glmGamPoi R package (not used here), that features
another clear explanation of pseudobulking.</li>
<li><a href="https://www.nature.com/articles/nmeth.4612">Bias,
robustness and scalability in single-cell differential expression
analysis</a> <span class="citation">(Soneson and Robinson 2018)</span> :
A review of single cell differential expression calculation
methods.</li>
<li><a href="https://satijalab.org/seurat/articles/de_vignette">Seurat
Differntial expression Vignette</a> : How to run differential expression
analyses using Seurat.</li>
<li><a
href="https://bioconductor.org/packages/release/bioc/vignettes/limma/inst/doc/usersguide.pdf">limma
documentation</a> <span class="citation">(Ritchie et al. 2015)</span>:
The complete manual to limma.</li>
<li><a
href="https://academic.oup.com/bioinformatics/article/21/9/2067/409024">Use
of within-array replicate spots for assessing differential expression in
microarray experiments</a><span class="citation">(Smyth, Michaud, and
Scott 2005)</span> : Paper describing the duplicate correlation approach
for pseudoreplicates (in the original context of micorarray
analysis).</li>
<li><a href="https://support.bioconductor.org/p/125489/">Bioconductor
support: Further clarification on when not to use duplicateCorrelation
with technical replicates (RNA-seq)</a> : A very helpful discussion
about when to use correlateDuplicates for pseuodreplicates.</li>
<li><a
href="https://ucdavis-bioinformatics-training.github.io/2018-June-RNA-Seq-Workshop/thursday/DE.html">Differential
Expression with Limma-Voom UC davis bioinformatics training</a> : A more
accessible explanation of bulk RNAseq analyses using limma.</li>
<li><a
href="https://genomicsclass.github.io/book/pages/interactions_and_contrasts.html">Interactions
and contrasts</a> : An excellent visual explanation of how to build
linear models for more complex multi-factor experimental designs
(e.g. treatment <em>and</em> genotype). Part of a larger <a
href="https://github.com/genomicsclass/book">Data Analysis for Genomics
class</a> resource.</li>
</ul>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-garrido-trigoMacrophageNeutrophilHeterogeneity2023"
class="csl-entry">
Garrido-Trigo, Alba, Ana M. Corraliza, Marisol Veny, Isabella Dotti,
Elisa Melón-Ardanaz, Aina Rill, Helena L. Crowell, et al. 2023.
<span>“Macrophage and Neutrophil Heterogeneity at Single-Cell Spatial
Resolution in Human Inflammatory Bowel Disease.”</span> <em>Nature
Communications</em> 14 (1): 4506. <a
href="https://doi.org/10.1038/s41467-023-40156-6">https://doi.org/10.1038/s41467-023-40156-6</a>.
</div>
<div id="ref-Ritchie2015" class="csl-entry">
Ritchie, Matthew E., Belinda Phipson, Di Wu, Yifang Hu, Charity W. Law,
Wei Shi, and Gordon K. Smyth. 2015. <span>“Limma Powers Differential
Expression Analyses for <span class="nocase">RNA-sequencing</span> and
Microarray Studies.”</span> <em>Nucleic Acids Research</em> 43 (7): e47.
<a
href="https://doi.org/10.1093/nar/gkv007">https://doi.org/10.1093/nar/gkv007</a>.
</div>
<div id="ref-smythUseWithinarrayReplicate2005" class="csl-entry">
Smyth, Gordon K., Joëlle Michaud, and Hamish S. Scott. 2005. <span>“Use
of Within-Array Replicate Spots for Assessing Differential Expression in
Microarray Experiments.”</span> <em>Bioinformatics</em> 21 (9): 2067–75.
<a
href="https://doi.org/10.1093/bioinformatics/bti270">https://doi.org/10.1093/bioinformatics/bti270</a>.
</div>
<div id="ref-Soneson2017" class="csl-entry">
Soneson, Charlotte, and Mark D Robinson. 2018. <span>“Bias, Robustness
and Scalability in Single-Cell Differential Expression Analysis.”</span>
<em>Nature Methods</em> 15 (4): 255–61. <a
href="https://doi.org/10.1038/nmeth.4612">https://doi.org/10.1038/nmeth.4612</a>.
</div>
</div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.4.0 (2024-04-24)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 
LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0

locale:
 [1] LC_CTYPE=en_AU.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_AU.UTF-8        LC_COLLATE=en_AU.UTF-8    
 [5] LC_MONETARY=en_AU.UTF-8    LC_MESSAGES=en_AU.UTF-8   
 [7] LC_PAPER=en_AU.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_AU.UTF-8 LC_IDENTIFICATION=C       

time zone: Etc/UTC
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices datasets  utils     methods   base     

other attached packages:
 [1] ggrepel_0.9.6      edgeR_4.4.2        DT_0.33            limma_3.62.2      
 [5] lubridate_1.9.4    forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4       
 [9] purrr_1.0.2        readr_2.1.5        tidyr_1.3.1        tibble_3.2.1      
[13] ggplot2_3.5.1      tidyverse_2.0.0    speckle_1.6.0      Seurat_5.2.1      
[17] SeuratObject_5.0.2 sp_2.2-0           workflowr_1.7.1   

loaded via a namespace (and not attached):
  [1] RcppAnnoy_0.0.22            splines_4.4.0              
  [3] later_1.4.1                 polyclip_1.10-7            
  [5] fastDummies_1.7.5           lifecycle_1.0.4            
  [7] rprojroot_2.0.4             globals_0.16.3             
  [9] processx_3.8.5              lattice_0.22-6             
 [11] MASS_7.3-64                 crosstalk_1.2.1            
 [13] magrittr_2.0.3              plotly_4.10.4              
 [15] sass_0.4.9                  rmarkdown_2.29             
 [17] jquerylib_0.1.4             yaml_2.3.10                
 [19] httpuv_1.6.15               sctransform_0.4.1          
 [21] spam_2.11-1                 spatstat.sparse_3.1-0      
 [23] reticulate_1.40.0           cowplot_1.1.3              
 [25] pbapply_1.7-2               RColorBrewer_1.1-3         
 [27] abind_1.4-8                 zlibbioc_1.52.0            
 [29] Rtsne_0.17                  GenomicRanges_1.58.0       
 [31] BiocGenerics_0.52.0         git2r_0.33.0               
 [33] GenomeInfoDbData_1.2.13     IRanges_2.40.1             
 [35] S4Vectors_0.44.0            irlba_2.3.5.1              
 [37] listenv_0.9.1               spatstat.utils_3.1-2       
 [39] goftest_1.2-3               RSpectra_0.16-2            
 [41] spatstat.random_3.3-2       fitdistrplus_1.2-2         
 [43] parallelly_1.42.0           codetools_0.2-20           
 [45] DelayedArray_0.32.0         tidyselect_1.2.1           
 [47] UCSC.utils_1.2.0            farver_2.1.2               
 [49] matrixStats_1.5.0           stats4_4.4.0               
 [51] spatstat.explore_3.3-4      jsonlite_1.8.9             
 [53] progressr_0.15.1            ggridges_0.5.6             
 [55] survival_3.8-3              tools_4.4.0                
 [57] ica_1.0-3                   Rcpp_1.0.14                
 [59] glue_1.8.0                  gridExtra_2.3              
 [61] SparseArray_1.6.1           xfun_0.50                  
 [63] MatrixGenerics_1.18.1       GenomeInfoDb_1.42.1        
 [65] withr_3.0.2                 BiocManager_1.30.25        
 [67] fastmap_1.2.0               callr_3.7.6                
 [69] digest_0.6.37               timechange_0.3.0           
 [71] R6_2.5.1                    mime_0.12                  
 [73] colorspace_2.1-1            scattermore_1.2            
 [75] tensor_1.5                  spatstat.data_3.1-4        
 [77] utf8_1.2.4                  generics_0.1.3             
 [79] renv_1.0.5                  data.table_1.16.4          
 [81] httr_1.4.7                  htmlwidgets_1.6.4          
 [83] S4Arrays_1.6.0              whisker_0.4.1              
 [85] uwot_0.2.2                  pkgconfig_2.0.3            
 [87] gtable_0.3.6                lmtest_0.9-40              
 [89] SingleCellExperiment_1.28.1 XVector_0.46.0             
 [91] htmltools_0.5.8.1           dotCall64_1.2              
 [93] scales_1.3.0                Biobase_2.66.0             
 [95] png_0.1-8                   spatstat.univar_3.1-1      
 [97] knitr_1.49                  rstudioapi_0.17.1          
 [99] tzdb_0.4.0                  reshape2_1.4.4             
[101] nlme_3.1-166                cachem_1.1.0               
[103] zoo_1.8-12                  KernSmooth_2.23-26         
[105] vipor_0.4.7                 parallel_4.4.0             
[107] miniUI_0.1.1.1              ggrastr_1.0.2              
[109] pillar_1.10.1               grid_4.4.0                 
[111] vctrs_0.6.5                 RANN_2.6.2                 
[113] promises_1.3.2              xtable_1.8-4               
[115] cluster_2.1.8               beeswarm_0.4.0             
[117] evaluate_1.0.3              cli_3.6.3                  
[119] locfit_1.5-9.11             compiler_4.4.0             
[121] rlang_1.1.5                 crayon_1.5.3               
[123] future.apply_1.11.3         labeling_0.4.3             
[125] ps_1.8.1                    ggbeeswarm_0.7.2           
[127] getPass_0.2-4               plyr_1.8.9                 
[129] fs_1.6.5                    stringi_1.8.4              
[131] viridisLite_0.4.2           deldir_2.0-4               
[133] munsell_0.5.1               lazyeval_0.2.2             
[135] spatstat.geom_3.3-5         Matrix_1.7-1               
[137] RcppHNSW_0.6.0              hms_1.1.3                  
[139] patchwork_1.3.0             future_1.34.0              
[141] statmod_1.5.0               shiny_1.10.0               
[143] SummarizedExperiment_1.36.0 ROCR_1.0-11                
[145] igraph_2.1.4                bslib_0.9.0                </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
